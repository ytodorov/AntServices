@model string
@{
    ViewBag.Title = "IP location";
    ViewBag.MetaDescription = "Free IP location service. Locate any IP address on a Google map.";
}

<div class="normalheader transition animated fadeIn small-header">
    <div class="hpanel">
        <div class="panel-body">
            <div id="hbreadcrumb" class="pull-right">
                <ol class="hbreadcrumb breadcrumb">
                    <li>
                        <a href="/">Home</a>
                    </li>
                </ol>
            </div>
            <h2 class="font-light m-b-xs">
                IP location
            </h2>
            <small>Locate IP address on a Google map.</small>
        </div>
    </div>
</div>

@Html.Partial("_Addresses", new AddressViewModel()
{
    ButtonId = "btnLocateIp",
    ButtonText = "Locate IP",
    DefaultDestinationAddress = Model,
    ShowSaveInHistory= false
}
)

<div id="map" style="width:100px;height: 10px"></div>
@section scripts {


    <script>

        $("#btnLocateIp").click(function f() {
            var ip = $("#ip").val();
            window.location.href = "iplocation?ip=" + ip;
        });
        if ('@Model'.length > 0) {
            setTimeout(function f() {
                $.ajax({
                    method: "POST",
                    url: "/home/getgooglemapsstring",
                    data: {
                        ip: '@Model'
                    },
                    success: function f(gmData) {
                        debugger;
                        $("#map").height($("#wrapper").height());
                        eval(gmData);
                    }
                });
            }, 10);
        };

        $(window).resize(function () {
            $("#map").height($("#wrapper").height());
        });
    </script>
}